
결론부터 말씀드리면, 말씀하신 대로 이 모델은 **PyTorch의 `torchvision.models`에서 제공하는 ResNet18 백본(Backbone)을 가져와 배터리 불량 검사 목적에 맞게 커스텀하여 사용하는 구조**가 맞습니다.

---

## 1. 모델 구성의 핵심 전략: Transfer Learning

이 모델의 가장 큰 특징은 **사전 학습된 모델(Pretrained Model)**을 활용한다는 점입니다.

* **백본(Backbone):** ImageNet-1K 데이터셋으로 미리 학습된 ResNet18을 사용합니다.
* **커스터마이징:** 마지막 출력 레이어(Fully Connected Layer)를 배터리 검사용인 **2개 클래스(정상/불량)**로 변경했습니다.
* **학습 방식:** `pretrained: true` 설정과 모든 파라미터를 학습 가능하게 두어, 배터리 CT 이미지의 특성에 맞게 전체 가중치를 미세 조정(Fine-tuning)합니다.

---

## 2. 레이어별 상세 분석

### ① 초기 레이어 (Stem Layer)

* **구성:**  Conv + BatchNorm + ReLU + MaxPool
* **역할:** 입력 이미지()를 빠르게 축소하면서 기본적인 특징(에지, 질감)을 추출합니다.
* **변화:** 공간 해상도가 에서 로 급격히 줄어들며 연산 효율을 높입니다.

### ② Residual Layers (4개 스테이지)

ResNet의 핵심인 **BasicBlock**이 반복되는 구간입니다.

* **Layer 1~4:** 단계적으로 채널 수를 늘리고() 공간 해상도를 줄입니다().
* **Skip Connection (Shortcut):** 입력을 출력에 직접 더해주는 구조를 통해, 층이 깊어져도 **기울기 소실(Gradient Vanishing)** 없이 학습이 안정적으로 이루어집니다.
* **파라미터 분포:** 전체 1,100만 개 파라미터 중 **약 75%가 마지막 Layer 4에 집중**되어 있습니다. 이는 고차원의 추상적 특징(결함의 종류 및 판단)을 처리하는 데 많은 용량을 할당했음을 의미합니다.

### ③ 출력 레이어 (Classification Head)

* **Global Average Pooling (GAP):**  크기의 특징 맵을 평균 내어 하나의 값으로 압축합니다. 위치 정보보다는 "어떤 특징이 존재하는가"에 집중하며 파라미터 수를 획기적으로 줄여 과적합을 방지합니다.
* **FC Layer:** 최종적으로 512차원의 벡터를 2차원(정상, 불량)으로 변환하여 확률을 출력합니다.

---

## 3. 데이터 흐름 요약 (Tensor Shape 변화)

| 단계 | 입력 크기 | 출력 크기 | 설명 |
| --- | --- | --- | --- |
| **Input** |  | - | 3채널 RGB 이미지 |
| **Stem** |  |  | 4배 하향 샘플링 |
| **Res Layers** |  |  | 채널 확장 및 특징 추출 |
| **Pooling** |  |  | 2D 정보를 1D 벡터로 압축 |
| **Output** |  | **2** | 정상/불량 최종 판정 |

---

## 4. 이 구조의 강점 분석 (배터리 검사 관점)

1. **해상도 최적화:**  고해상도 입력을 사용하여 미세한 크랙이나 이물질을 포착하기에 유리합니다.
2. **검증된 백본:** ResNet18은 가볍고 빠르면서도 성능이 검증되어 있어, 실시간 검사가 필요한 제조 현장에 적합합니다.
3. **확장성:** 문서 하단에 언급된 것처럼, 성능이 부족할 경우 동일한 인터페이스에서 `ResNet50`이나 `EfficientNet`으로 쉽게 교체할 수 있는 유연한 구조입니다.

